{"remainingRequest":"C:\\Users\\jimmy\\OneDrive\\Desktop\\RMS\\RMS\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\jimmy\\OneDrive\\Desktop\\RMS\\RMS\\src\\views\\AddNews.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\jimmy\\OneDrive\\Desktop\\RMS\\RMS\\src\\views\\AddNews.vue","mtime":1649512220689},{"path":"C:\\Users\\jimmy\\OneDrive\\Desktop\\RMS\\RMS\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1647724242346},{"path":"C:\\Users\\jimmy\\OneDrive\\Desktop\\RMS\\RMS\\node_modules\\babel-loader\\lib\\index.js","mtime":1647724241991},{"path":"C:\\Users\\jimmy\\OneDrive\\Desktop\\RMS\\RMS\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1647724242346},{"path":"C:\\Users\\jimmy\\OneDrive\\Desktop\\RMS\\RMS\\node_modules\\vue-loader\\lib\\index.js","mtime":1647724258599}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgTmV3c0NvdmVyUHJldmlldyBmcm9tICIuLi9jb21wb25lbnRzL05ld3NDb3ZlclByZXZpZXciOw0KaW1wb3J0IExvYWRpbmcgZnJvbSAiLi4vY29tcG9uZW50cy9Mb2FkaW5nIjsNCmltcG9ydCBmaXJlYmFzZSBmcm9tICJmaXJlYmFzZS9jb21wYXQvYXBwIjsNCmltcG9ydCAiZmlyZWJhc2UvY29tcGF0L3N0b3JhZ2UiOw0KaW1wb3J0IGRiIGZyb20gIi4uL2ZpcmViYXNlL2ZpcmViYXNlSW5pdCI7DQppbXBvcnQgUXVpbGwgZnJvbSAicXVpbGwiOw0Kd2luZG93LlF1aWxsID0gUXVpbGw7DQpjb25zdCBJbWFnZVJlc2l6ZSA9IHJlcXVpcmUoInF1aWxsLWltYWdlLXJlc2l6ZS1tb2R1bGUiKS5kZWZhdWx0Ow0KUXVpbGwucmVnaXN0ZXIoIm1vZHVsZXMvaW1hZ2VSZXNpemUiLCBJbWFnZVJlc2l6ZSk7DQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICJDcmVhdGVQb3N0IiwNCiAgZGF0YSgpIHsNCiAgICByZXR1cm4gew0KICAgICAgZmlsZTogbnVsbCwNCiAgICAgIGVycm9yOiBudWxsLA0KICAgICAgZXJyb3JNc2c6IG51bGwsDQogICAgICBsb2FkaW5nOiBudWxsLA0KICAgICAgZWRpdG9yU2V0dGluZ3M6IHsNCiAgICAgICAgbW9kdWxlczogew0KICAgICAgICAgIGltYWdlUmVzaXplOiB7fSwNCiAgICAgICAgfSwNCiAgICAgIH0sDQogICAgfTsNCiAgfSwNCiAgY29tcG9uZW50czogew0KICAgIE5ld3NDb3ZlclByZXZpZXcsDQogICAgTG9hZGluZywNCiAgfSwNCiAgbWV0aG9kczogew0KICAgIGZpbGVDaGFuZ2UoKSB7DQogICAgICB0aGlzLmZpbGUgPSB0aGlzLiRyZWZzLm5ld3NQaG90by5maWxlc1swXTsNCiAgICAgIGNvbnN0IGZpbGVOYW1lID0gdGhpcy5maWxlLm5hbWU7DQogICAgICB0aGlzLiRzdG9yZS5jb21taXQoImZpbGVOYW1lQ2hhbmdlIiwgZmlsZU5hbWUpOw0KICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCJjcmVhdGVGaWxlVVJMIiwgVVJMLmNyZWF0ZU9iamVjdFVSTCh0aGlzLmZpbGUpKTsNCiAgICB9LA0KDQogICAgb3BlblByZXZpZXcoKSB7DQogICAgICB0aGlzLiRzdG9yZS5jb21taXQoIm9wZW5QaG90b1ByZXZpZXciKTsNCiAgICB9LA0KDQogICAgaW1hZ2VIYW5kbGVyKGZpbGUsIEVkaXRvciwgY3Vyc29yTG9jYXRpb24sIHJlc2V0VXBsb2FkZXIpIHsNCiAgICAgIGNvbnN0IHN0b3JhZ2VSZWYgPSBmaXJlYmFzZS5zdG9yYWdlKCkucmVmKCk7DQogICAgICBjb25zdCBkb2NSZWYgPSBzdG9yYWdlUmVmLmNoaWxkKGBkb2N1bWVudHMvbmV3c1Bvc3RQaG90b3MvJHtmaWxlLm5hbWV9YCk7DQogICAgICBkb2NSZWYucHV0KGZpbGUpLm9uKA0KICAgICAgICAic3RhdGVfY2hhbmdlZCIsDQogICAgICAgIChzbmFwc2hvdCkgPT4gew0KICAgICAgICAgIGNvbnNvbGUubG9nKHNuYXBzaG90KTsNCiAgICAgICAgfSwNCiAgICAgICAgKGVycikgPT4gew0KICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7DQogICAgICAgIH0sDQogICAgICAgIGFzeW5jICgpID0+IHsNCiAgICAgICAgICBjb25zdCBkb3dubG9hZFVSTCA9IGF3YWl0IGRvY1JlZi5nZXREb3dubG9hZFVSTCgpOw0KICAgICAgICAgIEVkaXRvci5pbnNlcnRFbWJlZChjdXJzb3JMb2NhdGlvbiwgImltYWdlIiwgZG93bmxvYWRVUkwpOw0KICAgICAgICAgIHJlc2V0VXBsb2FkZXIoKTsNCiAgICAgICAgfQ0KICAgICAgKTsNCiAgICB9LA0KDQogICAgdXBsb2FkTmV3cygpIHsNCiAgICAgIGlmICh0aGlzLm5ld3NUaXRsZS5sZW5ndGggIT09IDAgJiYgdGhpcy5uZXdzSFRNTC5sZW5ndGggIT09IDApIHsNCiAgICAgICAgaWYgKHRoaXMuZmlsZSkgew0KICAgICAgICAgIHRoaXMubG9hZGluZyA9IHRydWU7DQogICAgICAgICAgY29uc3Qgc3RvcmFnZVJlZiA9IGZpcmViYXNlLnN0b3JhZ2UoKS5yZWYoKTsNCiAgICAgICAgICBjb25zdCBkb2NSZWYgPSBzdG9yYWdlUmVmLmNoaWxkKA0KICAgICAgICAgICAgYGRvY3VtZW50cy9uZXdzQ292ZXJQaG90b3MvJHt0aGlzLiRzdG9yZS5zdGF0ZS5uZXdzUGhvdG9OYW1lfWANCiAgICAgICAgICApOw0KICAgICAgICAgIGRvY1JlZi5wdXQodGhpcy5maWxlKS5vbigNCiAgICAgICAgICAgICJzdGF0ZV9jaGFuZ2VkIiwNCiAgICAgICAgICAgIChzbmFwc2hvdCkgPT4gew0KICAgICAgICAgICAgICBjb25zb2xlLmxvZyhzbmFwc2hvdCk7DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgKGVycikgPT4gew0KICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpOw0KICAgICAgICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTsNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBhc3luYyAoKSA9PiB7DQogICAgICAgICAgICAgIGNvbnN0IGRvd25sb2FkVVJMID0gYXdhaXQgZG9jUmVmLmdldERvd25sb2FkVVJMKCk7DQogICAgICAgICAgICAgIGNvbnN0IHRpbWVzdGFtcCA9IGF3YWl0IERhdGUubm93KCk7DQogICAgICAgICAgICAgIGNvbnN0IGRhdGFCYXNlID0gYXdhaXQgZGIuY29sbGVjdGlvbigibmV3c1Bvc3RzIikuZG9jKCk7DQoNCiAgICAgICAgICAgICAgYXdhaXQgZGF0YUJhc2Uuc2V0KHsNCiAgICAgICAgICAgICAgICBuZXdzSUQ6IGRhdGFCYXNlLmlkLA0KICAgICAgICAgICAgICAgIG5ld3NIVE1MOiB0aGlzLm5ld3NIVE1MLA0KICAgICAgICAgICAgICAgIG5ld3NDb3ZlclBob3RvOiBkb3dubG9hZFVSTCwNCiAgICAgICAgICAgICAgICBuZXdzQ292ZXJQaG90b05hbWU6IHRoaXMubmV3c0NvdmVyUGhvdG9OYW1lLA0KICAgICAgICAgICAgICAgIG5ld3NUaXRsZTogdGhpcy5uZXdzVGl0bGUsDQogICAgICAgICAgICAgICAgcHJvZmlsZUlkOiB0aGlzLnByb2ZpbGVJZCwNCiAgICAgICAgICAgICAgICBkYXRlOiB0aW1lc3RhbXAsDQogICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICBhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaCgiZ2V0UG9zdCIpOw0KICAgICAgICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTsNCiAgICAgICAgICAgICAgdGhpcy4kcm91dGVyLmdvKCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgKTsNCiAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCiAgICAgICAgdGhpcy5lcnJvciA9IHRydWU7DQogICAgICAgIHRoaXMuZXJyb3JNc2cgPSAiUGxlYXNlIGVuc3VyZSB5b3UgdXBsb2FkZWQgYSBjb3ZlciBwaG90byEiOw0KICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgICB0aGlzLmVycm9yID0gZmFsc2U7DQogICAgICAgIH0sIDUwMDApOw0KICAgICAgICByZXR1cm47DQogICAgICB9DQogICAgICB0aGlzLmVycm9yID0gdHJ1ZTsNCiAgICAgIHRoaXMuZXJyb3JNc2cgPSAiUGxlYXNlIGVuc3VyZSBOZXdzIFRpdGxlICYgTmV3cyBQb3N0IGhhcyBiZWVuIGZpbGxlZCEiOw0KICAgICAgc2V0VGltZW91dCgoKSA9PiB7DQogICAgICAgIHRoaXMuZXJyb3IgPSBmYWxzZTsNCiAgICAgIH0sIDUwMDApOw0KICAgICAgcmV0dXJuOw0KICAgIH0sDQogIH0sDQogIGNvbXB1dGVkOiB7DQogICAgcHJvZmlsZUlkKCkgew0KICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLnN0YXRlLnByb2ZpbGVJZDsNCiAgICB9LA0KICAgIG5ld3NDb3ZlclBob3RvTmFtZSgpIHsNCiAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5zdGF0ZS5uZXdzUGhvdG9OYW1lOw0KICAgIH0sDQogICAgbmV3c1RpdGxlOiB7DQogICAgICBnZXQoKSB7DQogICAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5zdGF0ZS5uZXdzVGl0bGU7DQogICAgICB9LA0KICAgICAgc2V0KHBheWxvYWQpIHsNCiAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCJ1cGRhdGVuZXdzVGl0bGUiLCBwYXlsb2FkKTsNCiAgICAgIH0sDQogICAgfSwNCiAgICBuZXdzSFRNTDogew0KICAgICAgZ2V0KCkgew0KICAgICAgICByZXR1cm4gdGhpcy4kc3RvcmUuc3RhdGUubmV3c0hUTUw7DQogICAgICB9LA0KICAgICAgc2V0KHBheWxvYWQpIHsNCiAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCJuZXdOZXdzUG9zdCIsIHBheWxvYWQpOw0KICAgICAgfSwNCiAgICB9LA0KICB9LA0KfTsNCg=="},{"version":3,"sources":["AddNews.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"AddNews.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <div class=\"create-post\">\r\n    <NewsCoverPreview v-show=\"this.$store.state.newsPhotoPreview\" />\r\n    <Loading v-show=\"loading\" />\r\n    <div class=\"container\">\r\n      <div :class=\"{ invisible: !error }\" class=\"err-message\">\r\n        <p><span>Error:</span>{{ this.errorMsg }}</p>\r\n      </div>\r\n      <div class=\"news-info\">\r\n        <input type=\"text\" placeholder=\"Enter News Title\" v-model=\"newsTitle\" />\r\n        <div class=\"upload-file\">\r\n          <label for=\"news-photo\">Upload Cover Photo</label>\r\n          <input\r\n            type=\"file\"\r\n            ref=\"newsPhoto\"\r\n            id=\"news-photo\"\r\n            @change=\"fileChange\"\r\n            accept=\".png, .jpg, ,jpeg\"\r\n          />\r\n          <button\r\n            @click=\"openPreview\"\r\n            class=\"preview\"\r\n            :class=\"{ 'button-inactive': !this.$store.state.newsPhotoFileURL }\"\r\n          >\r\n            Preview Photo\r\n          </button>\r\n          <span>File Chosen: {{ this.$store.state.newsPhotoName }}</span>\r\n        </div>\r\n      </div>\r\n      <div class=\"editor\">\r\n        <vue-editor\r\n          :editorOptions=\"editorSettings\"\r\n          v-model=\"newsHTML\"\r\n          useCustomImageHandler\r\n          @image-added=\"imageHandler\"\r\n        />\r\n      </div>\r\n      <div class=\"news-actions\">\r\n        <button @click=\"uploadNews\">Publish News</button>\r\n        <router-link class=\"router-button\" :to=\"{ name: 'NewsPreview' }\"\r\n          >Post Preview</router-link\r\n        >\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport NewsCoverPreview from \"../components/NewsCoverPreview\";\r\nimport Loading from \"../components/Loading\";\r\nimport firebase from \"firebase/compat/app\";\r\nimport \"firebase/compat/storage\";\r\nimport db from \"../firebase/firebaseInit\";\r\nimport Quill from \"quill\";\r\nwindow.Quill = Quill;\r\nconst ImageResize = require(\"quill-image-resize-module\").default;\r\nQuill.register(\"modules/imageResize\", ImageResize);\r\nexport default {\r\n  name: \"CreatePost\",\r\n  data() {\r\n    return {\r\n      file: null,\r\n      error: null,\r\n      errorMsg: null,\r\n      loading: null,\r\n      editorSettings: {\r\n        modules: {\r\n          imageResize: {},\r\n        },\r\n      },\r\n    };\r\n  },\r\n  components: {\r\n    NewsCoverPreview,\r\n    Loading,\r\n  },\r\n  methods: {\r\n    fileChange() {\r\n      this.file = this.$refs.newsPhoto.files[0];\r\n      const fileName = this.file.name;\r\n      this.$store.commit(\"fileNameChange\", fileName);\r\n      this.$store.commit(\"createFileURL\", URL.createObjectURL(this.file));\r\n    },\r\n\r\n    openPreview() {\r\n      this.$store.commit(\"openPhotoPreview\");\r\n    },\r\n\r\n    imageHandler(file, Editor, cursorLocation, resetUploader) {\r\n      const storageRef = firebase.storage().ref();\r\n      const docRef = storageRef.child(`documents/newsPostPhotos/${file.name}`);\r\n      docRef.put(file).on(\r\n        \"state_changed\",\r\n        (snapshot) => {\r\n          console.log(snapshot);\r\n        },\r\n        (err) => {\r\n          console.log(err);\r\n        },\r\n        async () => {\r\n          const downloadURL = await docRef.getDownloadURL();\r\n          Editor.insertEmbed(cursorLocation, \"image\", downloadURL);\r\n          resetUploader();\r\n        }\r\n      );\r\n    },\r\n\r\n    uploadNews() {\r\n      if (this.newsTitle.length !== 0 && this.newsHTML.length !== 0) {\r\n        if (this.file) {\r\n          this.loading = true;\r\n          const storageRef = firebase.storage().ref();\r\n          const docRef = storageRef.child(\r\n            `documents/newsCoverPhotos/${this.$store.state.newsPhotoName}`\r\n          );\r\n          docRef.put(this.file).on(\r\n            \"state_changed\",\r\n            (snapshot) => {\r\n              console.log(snapshot);\r\n            },\r\n            (err) => {\r\n              console.log(err);\r\n              this.loading = false;\r\n            },\r\n            async () => {\r\n              const downloadURL = await docRef.getDownloadURL();\r\n              const timestamp = await Date.now();\r\n              const dataBase = await db.collection(\"newsPosts\").doc();\r\n\r\n              await dataBase.set({\r\n                newsID: dataBase.id,\r\n                newsHTML: this.newsHTML,\r\n                newsCoverPhoto: downloadURL,\r\n                newsCoverPhotoName: this.newsCoverPhotoName,\r\n                newsTitle: this.newsTitle,\r\n                profileId: this.profileId,\r\n                date: timestamp,\r\n              });\r\n              await this.$store.dispatch(\"getPost\");\r\n              this.loading = false;\r\n              this.$router.go();\r\n            }\r\n          );\r\n          return;\r\n        }\r\n        this.error = true;\r\n        this.errorMsg = \"Please ensure you uploaded a cover photo!\";\r\n        setTimeout(() => {\r\n          this.error = false;\r\n        }, 5000);\r\n        return;\r\n      }\r\n      this.error = true;\r\n      this.errorMsg = \"Please ensure News Title & News Post has been filled!\";\r\n      setTimeout(() => {\r\n        this.error = false;\r\n      }, 5000);\r\n      return;\r\n    },\r\n  },\r\n  computed: {\r\n    profileId() {\r\n      return this.$store.state.profileId;\r\n    },\r\n    newsCoverPhotoName() {\r\n      return this.$store.state.newsPhotoName;\r\n    },\r\n    newsTitle: {\r\n      get() {\r\n        return this.$store.state.newsTitle;\r\n      },\r\n      set(payload) {\r\n        this.$store.commit(\"updatenewsTitle\", payload);\r\n      },\r\n    },\r\n    newsHTML: {\r\n      get() {\r\n        return this.$store.state.newsHTML;\r\n      },\r\n      set(payload) {\r\n        this.$store.commit(\"newNewsPost\", payload);\r\n      },\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.create-post {\r\n  position: relative;\r\n  height: 100%;\r\n\r\n  button {\r\n    margin-top: 0;\r\n  }\r\n\r\n  .router-button {\r\n    text-decoration: none;\r\n    color: #fff;\r\n  }\r\n\r\n  label,\r\n  button,\r\n  .router-button {\r\n    transition: 0.5s ease-in-out all;\r\n    align-self: center;\r\n    font-size: 14px;\r\n    cursor: pointer;\r\n    border-radius: 20px;\r\n    padding: 12px 24px;\r\n    color: #fff;\r\n    background-color: #303030;\r\n    text-decoration: none;\r\n\r\n    &:hover {\r\n      background-color: rgba(48, 48, 48, 0.7);\r\n    }\r\n  }\r\n\r\n  .container {\r\n    position: relative;\r\n    height: 100%;\r\n    padding: 10px 25px 60px;\r\n  }\r\n\r\n  // error styling\r\n  .invisible {\r\n    opacity: 0 !important;\r\n  }\r\n\r\n  .err-message {\r\n    width: 100%;\r\n    padding: 12px;\r\n    border-radius: 8px;\r\n    color: #fff;\r\n    margin-bottom: 10px;\r\n    background-color: #303030;\r\n    opacity: 1;\r\n    transition: 0.5s ease all;\r\n\r\n    p {\r\n      font-size: 14px;\r\n    }\r\n\r\n    span {\r\n      font-weight: 600;\r\n    }\r\n  }\r\n\r\n  .news-info {\r\n    display: flex;\r\n    margin-bottom: 32px;\r\n\r\n    input:nth-child(1) {\r\n      min-width: 300px;\r\n    }\r\n\r\n    input {\r\n      transition: 0.5s ease-in-out all;\r\n      padding: 10px 4px;\r\n      border: none;\r\n      border-bottom: 1px solid #303030;\r\n\r\n      &:focus {\r\n        outline: none;\r\n        box-shadow: 0 1px 0 0 #303030;\r\n      }\r\n    }\r\n\r\n    .upload-file {\r\n      flex: 1;\r\n      margin-left: 16px;\r\n      position: relative;\r\n      display: flex;\r\n\r\n      input {\r\n        display: none;\r\n      }\r\n\r\n      .preview {\r\n        margin-left: 16px;\r\n        text-transform: initial;\r\n      }\r\n\r\n      span {\r\n        font-size: 12px;\r\n        margin-left: 16px;\r\n        align-self: center;\r\n      }\r\n    }\r\n  }\r\n\r\n  .editor {\r\n    height: 60vh;\r\n    display: flex;\r\n    flex-direction: column;\r\n\r\n    .quillWrapper {\r\n      position: relative;\r\n      display: flex;\r\n      flex-direction: column;\r\n      height: 100%;\r\n    }\r\n\r\n    .ql-container {\r\n      display: flex;\r\n      flex-direction: column;\r\n      height: 100%;\r\n      overflow: scroll;\r\n    }\r\n\r\n    .ql-editor {\r\n      padding: 20px 16px 30px;\r\n    }\r\n  }\r\n\r\n  .news-actions {\r\n    margin-top: 32px;\r\n\r\n    button {\r\n      margin-right: 16px;\r\n    }\r\n  }\r\n}\r\n</style>\r\n"]}]}