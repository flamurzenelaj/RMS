{"remainingRequest":"D:\\jimmy\\UBT\\Semestri.5\\Zhvillimi dhe Dizajnimi i WEB-it - Betim Gashi\\PROJEKTI\\RMS VueJS\\RMS Vue JS\\RMS\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\jimmy\\UBT\\Semestri.5\\Zhvillimi dhe Dizajnimi i WEB-it - Betim Gashi\\PROJEKTI\\RMS VueJS\\RMS Vue JS\\RMS\\src\\views\\EditNews.vue?vue&type=style&index=0&lang=scss&","dependencies":[{"path":"D:\\jimmy\\UBT\\Semestri.5\\Zhvillimi dhe Dizajnimi i WEB-it - Betim Gashi\\PROJEKTI\\RMS VueJS\\RMS Vue JS\\RMS\\src\\views\\EditNews.vue","mtime":1647724259943},{"path":"D:\\jimmy\\UBT\\Semestri.5\\Zhvillimi dhe Dizajnimi i WEB-it - Betim Gashi\\PROJEKTI\\RMS VueJS\\RMS Vue JS\\RMS\\node_modules\\css-loader\\dist\\cjs.js","mtime":1647724244576},{"path":"D:\\jimmy\\UBT\\Semestri.5\\Zhvillimi dhe Dizajnimi i WEB-it - Betim Gashi\\PROJEKTI\\RMS VueJS\\RMS Vue JS\\RMS\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1647724258600},{"path":"D:\\jimmy\\UBT\\Semestri.5\\Zhvillimi dhe Dizajnimi i WEB-it - Betim Gashi\\PROJEKTI\\RMS VueJS\\RMS Vue JS\\RMS\\node_modules\\postcss-loader\\src\\index.js","mtime":1647724252550},{"path":"D:\\jimmy\\UBT\\Semestri.5\\Zhvillimi dhe Dizajnimi i WEB-it - Betim Gashi\\PROJEKTI\\RMS VueJS\\RMS Vue JS\\RMS\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1647724256815},{"path":"D:\\jimmy\\UBT\\Semestri.5\\Zhvillimi dhe Dizajnimi i WEB-it - Betim Gashi\\PROJEKTI\\RMS VueJS\\RMS Vue JS\\RMS\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1647724242346},{"path":"D:\\jimmy\\UBT\\Semestri.5\\Zhvillimi dhe Dizajnimi i WEB-it - Betim Gashi\\PROJEKTI\\RMS VueJS\\RMS Vue JS\\RMS\\node_modules\\vue-loader\\lib\\index.js","mtime":1647724258599}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKDQouY3JlYXRlLXBvc3Qgew0KICBwb3NpdGlvbjogcmVsYXRpdmU7DQogIGhlaWdodDogMTAwJTsNCg0KICBidXR0b24gew0KICAgIG1hcmdpbi10b3A6IDA7DQogIH0NCg0KICAucm91dGVyLWJ1dHRvbiB7DQogICAgdGV4dC1kZWNvcmF0aW9uOiBub25lOw0KICAgIGNvbG9yOiAjZmZmOw0KICB9DQoNCiAgbGFiZWwsDQogIGJ1dHRvbiwNCiAgLnJvdXRlci1idXR0b24gew0KICAgIHRyYW5zaXRpb246IDAuNXMgZWFzZS1pbi1vdXQgYWxsOw0KICAgIGFsaWduLXNlbGY6IGNlbnRlcjsNCiAgICBmb250LXNpemU6IDE0cHg7DQogICAgY3Vyc29yOiBwb2ludGVyOw0KICAgIGJvcmRlci1yYWRpdXM6IDIwcHg7DQogICAgcGFkZGluZzogMTJweCAyNHB4Ow0KICAgIGNvbG9yOiAjZmZmOw0KICAgIGJhY2tncm91bmQtY29sb3I6ICMzMDMwMzA7DQogICAgdGV4dC1kZWNvcmF0aW9uOiBub25lOw0KDQogICAgJjpob3ZlciB7DQogICAgICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDQ4LCA0OCwgNDgsIDAuNyk7DQogICAgfQ0KICB9DQoNCiAgLmNvbnRhaW5lciB7DQogICAgcG9zaXRpb246IHJlbGF0aXZlOw0KICAgIGhlaWdodDogMTAwJTsNCiAgICBwYWRkaW5nOiAxMHB4IDI1cHggNjBweDsNCiAgfQ0KDQogIC8vIGVycm9yIHN0eWxpbmcNCiAgLmludmlzaWJsZSB7DQogICAgb3BhY2l0eTogMCAhaW1wb3J0YW50Ow0KICB9DQoNCiAgLmVyci1tZXNzYWdlIHsNCiAgICB3aWR0aDogMTAwJTsNCiAgICBwYWRkaW5nOiAxMnB4Ow0KICAgIGJvcmRlci1yYWRpdXM6IDhweDsNCiAgICBjb2xvcjogI2ZmZjsNCiAgICBtYXJnaW4tYm90dG9tOiAxMHB4Ow0KICAgIGJhY2tncm91bmQtY29sb3I6ICMzMDMwMzA7DQogICAgb3BhY2l0eTogMTsNCiAgICB0cmFuc2l0aW9uOiAwLjVzIGVhc2UgYWxsOw0KDQogICAgcCB7DQogICAgICBmb250LXNpemU6IDE0cHg7DQogICAgfQ0KDQogICAgc3BhbiB7DQogICAgICBmb250LXdlaWdodDogNjAwOw0KICAgIH0NCiAgfQ0KDQogIC5uZXdzLWluZm8gew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgbWFyZ2luLWJvdHRvbTogMzJweDsNCg0KICAgIGlucHV0Om50aC1jaGlsZCgxKSB7DQogICAgICBtaW4td2lkdGg6IDMwMHB4Ow0KICAgIH0NCg0KICAgIGlucHV0IHsNCiAgICAgIHRyYW5zaXRpb246IDAuNXMgZWFzZS1pbi1vdXQgYWxsOw0KICAgICAgcGFkZGluZzogMTBweCA0cHg7DQogICAgICBib3JkZXI6IG5vbmU7DQogICAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgIzMwMzAzMDsNCg0KICAgICAgJjpmb2N1cyB7DQogICAgICAgIG91dGxpbmU6IG5vbmU7DQogICAgICAgIGJveC1zaGFkb3c6IDAgMXB4IDAgMCAjMzAzMDMwOw0KICAgICAgfQ0KICAgIH0NCg0KICAgIC51cGxvYWQtZmlsZSB7DQogICAgICBmbGV4OiAxOw0KICAgICAgbWFyZ2luLWxlZnQ6IDE2cHg7DQogICAgICBwb3NpdGlvbjogcmVsYXRpdmU7DQogICAgICBkaXNwbGF5OiBmbGV4Ow0KDQogICAgICBpbnB1dCB7DQogICAgICAgIGRpc3BsYXk6IG5vbmU7DQogICAgICB9DQoNCiAgICAgIC5wcmV2aWV3IHsNCiAgICAgICAgbWFyZ2luLWxlZnQ6IDE2cHg7DQogICAgICAgIHRleHQtdHJhbnNmb3JtOiBpbml0aWFsOw0KICAgICAgfQ0KDQogICAgICBzcGFuIHsNCiAgICAgICAgZm9udC1zaXplOiAxMnB4Ow0KICAgICAgICBtYXJnaW4tbGVmdDogMTZweDsNCiAgICAgICAgYWxpZ24tc2VsZjogY2VudGVyOw0KICAgICAgfQ0KICAgIH0NCiAgfQ0KDQogIC5lZGl0b3Igew0KICAgIGhlaWdodDogNjB2aDsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47DQoNCiAgICAucXVpbGxXcmFwcGVyIHsNCiAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsNCiAgICAgIGRpc3BsYXk6IGZsZXg7DQogICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOw0KICAgICAgaGVpZ2h0OiAxMDAlOw0KICAgIH0NCg0KICAgIC5xbC1jb250YWluZXIgew0KICAgICAgZGlzcGxheTogZmxleDsNCiAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47DQogICAgICBoZWlnaHQ6IDEwMCU7DQogICAgICBvdmVyZmxvdzogc2Nyb2xsOw0KICAgIH0NCg0KICAgIC5xbC1lZGl0b3Igew0KICAgICAgcGFkZGluZzogMjBweCAxNnB4IDMwcHg7DQogICAgfQ0KICB9DQoNCiAgLm5ld3MtYWN0aW9ucyB7DQogICAgbWFyZ2luLXRvcDogMzJweDsNCg0KICAgIGJ1dHRvbiB7DQogICAgICBtYXJnaW4tcmlnaHQ6IDE2cHg7DQogICAgfQ0KICB9DQp9DQo="},{"version":3,"sources":["EditNews.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkLA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"EditNews.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <div class=\"create-post\">\r\n    <NewsCoverPreview v-show=\"this.$store.state.newsPhotoPreview\" />\r\n    <Loading v-show=\"loading\" />\r\n    <div class=\"container\">\r\n      <div :class=\"{ invisible: !error }\" class=\"err-message\">\r\n        <p><span>Error:</span>{{ this.errorMsg }}</p>\r\n      </div>\r\n      <div class=\"news-info\">\r\n        <input type=\"text\" placeholder=\"Enter News Title\" v-model=\"newsTitle\" />\r\n        <div class=\"upload-file\">\r\n          <label for=\"news-photo\">Upload Cover Photo</label>\r\n          <input type=\"file\" ref=\"newsPhoto\" id=\"news-photo\" @change=\"fileChange\" accept=\".png, .jpg, ,jpeg\" />\r\n          <button @click=\"openPreview\" class=\"preview\" :class=\"{ 'button-inactive': !this.$store.state.newsPhotoFileURL }\">\r\n            Preview Photo\r\n          </button>\r\n          <span>File Chosen: {{ this.$store.state.newsPhotoName }}</span>\r\n        </div>\r\n      </div>\r\n      <div class=\"editor\">\r\n        <vue-editor :editorOptions=\"editorSettings\" v-model=\"newsHTML\" useCustomImageHandler @image-added=\"imageHandler\" />\r\n      </div>\r\n      <div class=\"news-actions\">\r\n        <button @click=\"updateNews\">Save Changes</button>\r\n        <router-link class=\"router-button\" :to=\"{ name: 'NewsPreview' }\">Preview Changes</router-link>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport NewsCoverPreview from \"../components/NewsCoverPreview\";\r\nimport Loading from \"../components/Loading\";\r\nimport firebase from \"firebase/compat/app\";\r\nimport \"firebase/storage\";\r\nimport db from \"../firebase/firebaseInit\";\r\nimport Quill from \"quill\";\r\nwindow.Quill = Quill;\r\nconst ImageResize = require(\"quill-image-resize-module\").default;\r\nQuill.register(\"modules/imageResize\", ImageResize);\r\nexport default {\r\n  name: \"CreatePost\",\r\n  data() {\r\n    return {\r\n      file: null,\r\n      error: null,\r\n      errorMsg: null,\r\n      loading: null,\r\n      routeID: null,\r\n      currentNews: null,\r\n      editorSettings: {\r\n        modules: {\r\n          imageResize: {},\r\n        },\r\n      },\r\n    };\r\n  },\r\n  components: {\r\n    NewsCoverPreview,\r\n    Loading,\r\n  },\r\n  async mounted() {\r\n    this.routeID = this.$route.params.newsid;\r\n    this.currentNews = await this.$store.state.newsPosts.filter((post) => {\r\n      return post.newsID === this.routeID;\r\n    });\r\n    this.$store.commit(\"setNewsState\", this.currentNews[0]);\r\n  },\r\n  methods: {\r\n    fileChange() {\r\n      this.file = this.$refs.newsPhoto.files[0];\r\n      const fileName = this.file.name;\r\n      this.$store.commit(\"fileNameChange\", fileName);\r\n      this.$store.commit(\"createFileURL\", URL.createObjectURL(this.file));\r\n    },\r\n\r\n    openPreview() {\r\n      this.$store.commit(\"openPhotoPreview\");\r\n    },\r\n\r\n    imageHandler(file, Editor, cursorLocation, resetUploader) {\r\n      const storageRef = firebase.storage().ref();\r\n      const docRef = storageRef.child(`documents/newsPostPhotos/${file.name}`);\r\n      docRef.put(file).on(\r\n        \"state_changed\",\r\n        (snapshot) => {\r\n          console.log(snapshot);\r\n        },\r\n        (err) => {\r\n          console.log(err);\r\n        },\r\n        async () => {\r\n          const downloadURL = await docRef.getDownloadURL();\r\n          Editor.insertEmbed(cursorLocation, \"image\", downloadURL);\r\n          resetUploader();\r\n        }\r\n      );\r\n    },\r\n\r\n    async updateNews() {\r\n      const dataBase = await db.collection(\"newsPosts\").doc(this.routeID);\r\n      if (this.newsTitle.length !== 0 && this.newsHTML.length !== 0) {\r\n        if (this.file) {\r\n          this.loading = true;\r\n          const storageRef = firebase.storage().ref();\r\n          const docRef = storageRef.child(`documents/newsCoverPhotos/${this.$store.state.newsPhotoName}`);\r\n          docRef.put(this.file).on(\r\n            \"state_changed\",\r\n            (snapshot) => {\r\n              console.log(snapshot);\r\n            },\r\n            (err) => {\r\n              console.log(err);\r\n              this.loading = false;\r\n            },\r\n            async () => {\r\n              const downloadURL = await docRef.getDownloadURL();\r\n\r\n              await dataBase.update({\r\n                newsHTML: this.newsHTML,\r\n                newsCoverPhoto: downloadURL,\r\n                newsCoverPhotoName: this.newsCoverPhotoName,\r\n                newsTitle: this.newsTitle,\r\n              });\r\n              await this.$store.dispatch(\"updatePost\", this.routeID);\r\n              this.loading = false;\r\n              this.$router.push({ name: \"ViewNews\", params: { newsid: dataBase.id } });\r\n            }\r\n          );\r\n          return;\r\n        }\r\n        this.loading = true;\r\n        //if this.file==false means that the image hasn't changed so we update only title and desciption\r\n        await dataBase.update({\r\n          newsHTML: this.newsHTML,\r\n          newsTitle: this.newsTitle,\r\n        });\r\n        await this.$store.dispatch(\"updatePost\", this.routeID);\r\n        this.loading = false;\r\n        this.$router.push({ name: \"ViewNews\", params: { newsid: dataBase.id } });\r\n        return;\r\n      }\r\n      this.error = true;\r\n      this.errorMsg = \"Please ensure News Title & News Post has been filled!\";\r\n      setTimeout(() => {\r\n        this.error = false;\r\n      }, 5000);\r\n      return;\r\n    },\r\n  },\r\n  computed: {\r\n    profileId() {\r\n      return this.$store.state.profileId;\r\n    },\r\n    newsCoverPhotoName() {\r\n      return this.$store.state.newsPhotoName;\r\n    },\r\n    newsTitle: {\r\n      get() {\r\n        return this.$store.state.newsTitle;\r\n      },\r\n      set(payload) {\r\n        this.$store.commit(\"updatenewsTitle\", payload);\r\n      },\r\n    },\r\n    newsHTML: {\r\n      get() {\r\n        return this.$store.state.newsHTML;\r\n      },\r\n      set(payload) {\r\n        this.$store.commit(\"newNewsPost\", payload);\r\n      },\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.create-post {\r\n  position: relative;\r\n  height: 100%;\r\n\r\n  button {\r\n    margin-top: 0;\r\n  }\r\n\r\n  .router-button {\r\n    text-decoration: none;\r\n    color: #fff;\r\n  }\r\n\r\n  label,\r\n  button,\r\n  .router-button {\r\n    transition: 0.5s ease-in-out all;\r\n    align-self: center;\r\n    font-size: 14px;\r\n    cursor: pointer;\r\n    border-radius: 20px;\r\n    padding: 12px 24px;\r\n    color: #fff;\r\n    background-color: #303030;\r\n    text-decoration: none;\r\n\r\n    &:hover {\r\n      background-color: rgba(48, 48, 48, 0.7);\r\n    }\r\n  }\r\n\r\n  .container {\r\n    position: relative;\r\n    height: 100%;\r\n    padding: 10px 25px 60px;\r\n  }\r\n\r\n  // error styling\r\n  .invisible {\r\n    opacity: 0 !important;\r\n  }\r\n\r\n  .err-message {\r\n    width: 100%;\r\n    padding: 12px;\r\n    border-radius: 8px;\r\n    color: #fff;\r\n    margin-bottom: 10px;\r\n    background-color: #303030;\r\n    opacity: 1;\r\n    transition: 0.5s ease all;\r\n\r\n    p {\r\n      font-size: 14px;\r\n    }\r\n\r\n    span {\r\n      font-weight: 600;\r\n    }\r\n  }\r\n\r\n  .news-info {\r\n    display: flex;\r\n    margin-bottom: 32px;\r\n\r\n    input:nth-child(1) {\r\n      min-width: 300px;\r\n    }\r\n\r\n    input {\r\n      transition: 0.5s ease-in-out all;\r\n      padding: 10px 4px;\r\n      border: none;\r\n      border-bottom: 1px solid #303030;\r\n\r\n      &:focus {\r\n        outline: none;\r\n        box-shadow: 0 1px 0 0 #303030;\r\n      }\r\n    }\r\n\r\n    .upload-file {\r\n      flex: 1;\r\n      margin-left: 16px;\r\n      position: relative;\r\n      display: flex;\r\n\r\n      input {\r\n        display: none;\r\n      }\r\n\r\n      .preview {\r\n        margin-left: 16px;\r\n        text-transform: initial;\r\n      }\r\n\r\n      span {\r\n        font-size: 12px;\r\n        margin-left: 16px;\r\n        align-self: center;\r\n      }\r\n    }\r\n  }\r\n\r\n  .editor {\r\n    height: 60vh;\r\n    display: flex;\r\n    flex-direction: column;\r\n\r\n    .quillWrapper {\r\n      position: relative;\r\n      display: flex;\r\n      flex-direction: column;\r\n      height: 100%;\r\n    }\r\n\r\n    .ql-container {\r\n      display: flex;\r\n      flex-direction: column;\r\n      height: 100%;\r\n      overflow: scroll;\r\n    }\r\n\r\n    .ql-editor {\r\n      padding: 20px 16px 30px;\r\n    }\r\n  }\r\n\r\n  .news-actions {\r\n    margin-top: 32px;\r\n\r\n    button {\r\n      margin-right: 16px;\r\n    }\r\n  }\r\n}\r\n</style>\r\n"]}]}